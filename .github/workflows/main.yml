name: Deploy to development
on:
  push:
    branches:
      - main
jobs:
  deploy:
    runs-on: ubuntu-latest
    name: Build, Test and Deploy
    steps:
      - name: Checkout 
        uses: actions/checkout@v2
        with:
          persist-credentials: false
      - name: Install
        run: npm install
      - name: Build Webapp
        run:  npm run build-webapp:ci
      - name: List /build
        run: ls ./build
      - name: List /webapp
        run: ls ./webapp
      - name: Deploy webapp
        uses: milanmk/actions-file-deployer@master
        with:
          remote-protocol: "sftp"
          remote-host:  ${{ secrets.FTP_SERVER }}
          remote-user: ${{ secrets.FTP_USER }}
          remote-port: 2137
          ssh-private-key: ${{ secrets.FTP_PRIVATE_KEY }} 
          remote-path: "/fern/web/fern/"
          sync: "full"
          local-path: "webapp/"
